(()=>{"use strict";class e{constructor(e,t,s){this._name=e.name,this._link=e.link,this._selector=t,this._handleImageClick=s}generateCard(){return this._element=document.querySelector(this._selector).content.querySelector(".card").cloneNode(!0),this._imageElement=this._element.querySelector(".card__image"),this._setEventListeners(),this._element.querySelector(".card__title").textContent=this._name,this._imageElement.src=this._link,this._imageElement.alt=this._name,this._element}_setEventListeners(){this._element.querySelector(".card__button").addEventListener("click",(e=>this._toggleLike(e))),this._element.querySelector(".card__delete").addEventListener("click",(()=>this._deleteCard())),this._imageElement.addEventListener("click",(()=>this._handleImageClick(this._name,this._link)))}_toggleLike(e){e.target.classList.toggle("card__button_like")}_deleteCard(){this._element.remove()}}class t{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t}_showInputError(e,t){const s=this._formElement.querySelector(`.${e.name}-error`);e.classList.add(this._inputErrorClass),s.textContent=t}_hideInputError(e){const t=this._formElement.querySelector(`.${e.name}-error`);e.classList.remove(this._inputErrorClass),t.textContent=""}enableValidation(){this._formElement.addEventListener("submit",(e=>e.preventDefault())),this._setEventListeners()}_setEventListeners(){const e=Array.from(this._formElement.querySelectorAll(this._inputSelector)),t=this._formElement.querySelector(this._submitButtonSelector);this._disableButton(t),this._formElement.addEventListener("reset",(()=>{e.forEach((e=>{this._hideInputError(e)})),this._disableButton(t)})),e.forEach((s=>{s.addEventListener("input",(()=>{this._checkInputValidity(s),this._toggleButtonState(e,t)}))}))}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_toggleButtonState(e,t){this._hasInvalidInput(e)?this._disableButton(t):(t.classList.remove(this._inactiveButtonClass),t.removeAttribute("disabled"))}_disableButton(e){e.classList.add(this._inactiveButtonClass),e.setAttribute("disabled","")}_hasInvalidInput(e){return e.some((e=>!e.validity.valid))}}class s{constructor(e){this.popup=document.querySelector(e),this._bindHandleEscClose=this._handleEscClose.bind(this)}openPopup(){document.addEventListener("keydown",this._bindHandleEscClose),this.popup.classList.add("popup_active")}closePopup(){document.removeEventListener("keydown",this._bindHandleEscClose),this.popup.classList.remove("popup_active")}_handleEscClose(e){27===e.keyCode&&this.closePopup()}setEventListeners(){this.popup.addEventListener("mousedown",(e=>{(e.target===e.currentTarget||e.target.classList.contains("popup__button-close"))&&this.closePopup()}))}}class r extends s{constructor(e,t){super(e),this._submitHandler=t,this._formPopup=this.popup.querySelector(".popup__form")}openPopup(){this._formPopup.reset(),super.openPopup()}setEventListeners(){super.setEventListeners(),this.popup.addEventListener("submit",(e=>{this._submitHandler(e)}))}}const n={inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},o=new class{constructor({selectorUserName:e,selectorUserInfo:t}){this._nameUser=document.querySelector(e),this._infoUser=document.querySelector(t)}getUserInfo(){return{name:this._nameUser.textContent,info:this._infoUser.textContent}}setUserInfo(e,t){this._nameUser.textContent=e,this._infoUser.textContent=t}}({selectorUserName:".profile__name",selectorUserInfo:".profile__about-me"}),i=new r(".page__edit-popup",(e=>{e.preventDefault(),o.setUserInfo(c.value,d.value),i.closePopup()})),a=new r(".page__add-popup",(t=>{t.preventDefault();const s=new e({name:v.value,link:E.value},".template-card",p.openPopup.bind(p)).generateCard();l.addItem(s),a.closePopup()})),p=new class extends s{constructor(e){super(e)}openPopup(e,t){const s=this.popup.querySelector(".popup__image");s.src=t,s.alt=e,this.popup.querySelector(".popup__subtitle").textContent=e,super.openPopup()}}(".page__card-popup"),l=new class{constructor({data:e,renderer:t},s){this._renderedItems=e,this._renderer=t,this._container=document.querySelector(s)}addItem(e){this._container.prepend(e)}clear(){this._container.innerHTML=""}renderItems(){this._renderedItems.forEach((e=>{this._renderer(e)}))}}({data:[{name:"Красноярск",link:"./images/krasnoyarsk.jpg"},{name:"Сочи",link:"./images/sochi.jpg"},{name:"Нижний Новгород",link:"./images/nizhny_novgorod.jpg"},{name:"Камчатка",link:"./images/kamchatka.jpg"},{name:"Москва",link:"./images/moscow.jpg"},{name:"Санкт-Петербург",link:"./images/st-petersburg.jpg"}],renderer:t=>{const s=new e(t,".template-card",p.openPopup.bind(p)).generateCard();l.addItem(s)}},".cards"),u=i.popup.querySelector(".popup__form"),_=document.querySelector(".profile__edit-button"),c=u.querySelector(".popup__input_field_name"),d=u.querySelector(".popup__input_field_about-me"),m=a.popup.querySelector(".popup__form"),h=document.querySelector(".profile__add-button"),v=m.querySelector(".popup__input_field_card-name"),E=m.querySelector(".popup__input_field_card-link"),g=i.openPopup.bind(i),f=[i,a,p];l.renderItems(),Array.from(document.querySelectorAll(".popup__form")).forEach((e=>{new t(n,e).enableValidation()})),_.addEventListener("click",(()=>{g(),({name:c.value,info:d.value}=o.getUserInfo())})),h.addEventListener("click",a.openPopup.bind(a)),f.forEach((e=>{e.setEventListeners()}))})();